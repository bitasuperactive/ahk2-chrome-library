<!-- HTML header for doxygen 1.15.0-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="es">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.15.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>CHROME LIBRARY: Inicio</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
 <td>
  <a href="https://github.com/bitasuperactive/ahk2-chrome-library" target="_blank" title="Repositorio en GitHub">
    <img src="res/github_logo.png" alt="GitHub" height="56">
  </a>
</td>
  <td id="projectalign">
   <div id="projectname">CHROME LIBRARY<span id="projectnumber">&#160;1.1.0</span>
   </div>
   <div id="projectbrief">¡Automiza Chrome con AHK v2!</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generado por Doxygen 1.15.0 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search/",'.html');
</script>
<script type="text/javascript">
$(function() { codefold.init(); });
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Buscar',true);
  $(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(function(){initNavTree('index.html','',''); });
</script>
<div id="container">
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Cargando...</div>
<div class="SRStatus" id="Searching">Buscando...</div>
<div class="SRStatus" id="NoMatches">Nada coincide</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Inicio </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><div align="center"> <h1>CHROME LIBRARY</h1>
</div><div align="center"> </div><p><a href="https://bitasuperactive.github.io/ahk2-chrome-library/"><img src="https://img.shields.io/badge/Documentación-HTML-blue?style=for-the-badge" alt="Documentation" class="inline"/></a></p>
<p><b>Chrome Library</b> es una implementación de la librería <a href="https://github.com/thqby/ahk2_lib/blob/master/Chrome.ahk">ahk2_lib/Chrome</a> desarrollada por <a href="https://github.com/thqby/">thqby</a>. Proporciona una implementación ligera de automatización de Google Chrome utilizando el <a href="https://chromedevtools.github.io/devtools-protocol/" target="_blank">⇱Chrome DevTools Protocol (CDP)</a> mediante <a class="el" href="class_web_socket.html" title="Cliente WebSocket (WinHTTP API) compatible con AutoHotKey v2.">WebSocket</a> en <a href="https://www.autohotkey.com/v2/" target="_blank">⇱AutoHotkey V2</a>. El objetivo es ofrecer una alternativa minimalista a herramientas como Selenium o Puppeteer, permitiendo:</p><ul>
<li>Control directo del navegador</li>
<li>Ejecución de JavaScript</li>
<li>Navegación avanzada</li>
<li>Automatización de formularios</li>
<li>Gestión de pestañas</li>
</ul>
<p>El proyecto se compone de tres clases principales:</p>
<h3>1️⃣ <a class="el" href="class_chrome_v2.html" title="Automatiza Google Chrome mediante el Chrome DevTools Protocol.">ChromeV2</a></h3>
<p>Responsable de la gestión del navegador a nivel HTTP (/json endpoint).</p>
<h3>2️⃣ <a class="el" href="class_chrome_v2_1_1_page.html" title="Representa una conexión WebSocket a la interfaz de depuración de una página de Chrome.">ChromeV2.Page</a></h3>
<p>Encapsula la conexión <a class="el" href="class_web_socket.html" title="Cliente WebSocket (WinHTTP API) compatible con AutoHotKey v2.">WebSocket</a> al Chrome DevTools Protocol.</p>
<h3>3️⃣ <a class="el" href="class_j_s_wrapper.html" title="JavaScript Wrapper para ChromeV2.Page, proporciona métodos específicos para interactuar con elementos...">JSWrapper</a></h3>
<p>Simplifica la automatización mediante métodos de alto nivel que encapsulan JavaScript común.</p>
<h2 class="doxsection"><a class="anchor" id="autotoc_md0"></a>
Ejemplo básico</h2>
<p>Vamos a crear un automatismo que inicie sesión en una página web de prueba.</p>
<p>Inicializamos nuestra instancia de Chrome Debug. Yo guardaré los datos de la aplicación en el directorio "C:\Temp\ChromeDebug", el resto de los parámetros los podemos dejar por defecto, como el puerto de escucha 9222. </p><dl class="section remark"><dt>Comentarios</dt><dd>La primera vez que ejecutemos el debugger de Chrome, nos pedirá configurar el navegador.</dd></dl>
<div class="fragment"><div class="line">chromeManager := ChromeV2(,, ProfilePath := &quot;C:\Temp\ChromeDebug&quot;)</div>
</div><!-- fragment --><p>Instanciamos el envoltorio de JavaScript que nos permitirá abrir, conectar e interactuar con la página. </p><div class="fragment"><div class="line">loginPage := JSWrapper(chromeManager, &quot;https://the-internet.herokuapp.com/login&quot;)</div>
</div><!-- fragment --><p>Para mostrar la administración de pestañas, vamos a cerrar la pestaña en blanco que nos abre Chrome.</p>
<div class="fragment"><div class="line">blankPages := chromeManager.FindPages({url: &quot;chrome://newtab/&quot;}, matchMode := &quot;exact&quot;)</div>
<div class="line">chromeManager.ClosePage(blankPages[1], &quot;exact&quot;)</div>
</div><!-- fragment --><p>Ejecutamos la función predefinida para el inicio de sesión indicando los selectores CSS para el input del usuario y contraseña, y para el mensaje de error en caso de que lo hubiera. </p><dl class="section remark"><dt>Comentarios</dt><dd>Para encontrar el selector de un elemento en HTML como un botón, hacemos clic derecho en él, inspeccionar, clic derecho sobre la línea HTML del elemento y "copiar selector".</dd></dl>
<div class="fragment"><div class="line">result := loginPage.Login(selectorUserInput := &quot;#username&quot;</div>
<div class="line">    , selectorPasswordInput := &quot;#password&quot;</div>
<div class="line">    , selectorLoginButton := &quot;button[type=&#39;submit&#39;]&quot;</div>
<div class="line">    , selectorErrorOutput := &quot;#flash.error&quot;</div>
<div class="line">    , userName := &quot;tomsmith&quot;</div>
<div class="line">    , password := &quot;SuperSecretPassword!&quot;</div>
<div class="line">)</div>
<div class="line">if (result)</div>
<div class="line">    MsgBox(&quot;Login exitoso.&quot;)</div>
<div class="line">else</div>
<div class="line">    MsgBox(&quot;Error de autenticación.&quot;)</div>
</div><!-- fragment --><p>Y por supuesto, podemos ejecutar instrucciones JS directamente.</p>
<div class="fragment"><div class="line">loginPage.WaitForEvaluate(&#39;document.querySelector(&quot;#content &gt; div &gt; a &gt; i&quot;).click()&#39;) ; hace clic en logout</div>
</div><!-- fragment --><h4 class="doxsection"><a class="anchor" id="autotoc_md1"></a>
¡Pruébalo en tu script!</h4>
<p>Así de fácil es automatizar la mayoría de páginas web. La clase <a class="el" href="class_j_s_wrapper.html" title="JavaScript Wrapper para ChromeV2.Page, proporciona métodos específicos para interactuar con elementos...">JSWrapper</a> te facilita las funciones esenciales para las interacciones HTML que necesitarás. Siéntete libre que modificarla a conveniencia, pero antes échale un vistazo a la <a href="https://bitasuperactive.github.io/ahk2-chrome-library/annotated.html">documentación de clases</a>.  </p>
<h2 class="doxsection"><a class="anchor" id="autotoc_md2"></a>
Métodos y clases esenciales</h2>
<h4 class="doxsection"><a class="anchor" id="autotoc_md3"></a>
<a class="el" href="class_chrome_v2.html#ad2b8d9b1c5f5c73014e053f35be3a863">Chrome</a></h4>
<blockquote class="doxtable">
<p>Inicia o conecta una instancia de Google Chrome en modo depuración y abre las URL(s) indicadas si no están ya abiertas.   </p>
<dl class="params"><dt>Parámetros</dt><dd>
  <table class="params">
    <tr><td class="paramname">{String}</td><td>ChromePath (Opcional) Ruta completa al ejecutable de Chrome. Si se deja en blanco, se buscará en los accesos directos, registros del sistema y en la ruta estándar. </td></tr>
    <tr><td class="paramname">{Integer}</td><td>DebugPort (Opcional) Puerto local para el modo depuración. Por defecto: <span class="tt">9222</span>. </td></tr>
    <tr><td class="paramname">{String}</td><td>ProfilePath (Opcional) Ruta al perfil de usuario de Chrome. Si no se establece, se utilizará la ruta estándar. </td></tr>
    <tr><td class="paramname">{String}</td><td>Flags (Opcional) Banderas adicionales para el lanzamiento de Chrome. </td></tr>
    <tr><td class="paramname">{String|Array&lt;String&gt;}</td><td>URLs (Opcional) URL o colección de URL(s) a abrir al iniciar o conectar Chrome. Si la url exacta ya se encuentra abierta, no se vuelve a abrir.    <br  />
<br  />
 </td></tr>
  </table>
  </dd>
</dl>
</blockquote>
<h4 class="doxsection"><a class="anchor" id="autotoc_md4"></a>
<a class="el" href="class_chrome_v2_1_1_page.html">Page</a></h4>
<blockquote class="doxtable">
<p>Representa una conexión <a class="el" href="class_web_socket.html" title="Cliente WebSocket (WinHTTP API) compatible con AutoHotKey v2.">WebSocket</a> a la interfaz de depuración de una página de Chrome.   </p>
<dl class="section see"><dt>Ver también</dt><dd><a href="https://chromedevtools.github.io/devtools-protocol">https://chromedevtools.github.io/devtools-protocol</a>    <br  />
<br  />
 </dd></dl>
</blockquote>
<h4 class="doxsection"><a class="anchor" id="autotoc_md5"></a>
<a class="el" href="class_chrome_v2_1_1_page.html#af5e46e2b35b8d2764e65ea4df3861380">WaitForEvaluate</a></h4>
<blockquote class="doxtable">
<p>Ejecuta instrucciones JavaScript y espera a que cargue el documento.    <br  />
<br  />
 </p>
</blockquote>
<h4 class="doxsection"><a class="anchor" id="autotoc_md6"></a>
<a class="el" href="class_j_s_wrapper.html">JSWrapper</a></h4>
<blockquote class="doxtable">
<p>Crea una nueva instancia de <span class="tt"><a class="el" href="class_j_s_wrapper.html" title="JavaScript Wrapper para ChromeV2.Page, proporciona métodos específicos para interactuar con elementos...">JSWrapper</a></span> vinculada a una página de Chrome específica, identificada por su URL.   </p>
<dl class="section note"><dt>Nota</dt><dd>Controla el cierre manual o inesperado del proceso de Chrome lanzando un error. </dd></dl>
<dl class="params"><dt>Parámetros</dt><dd>
  <table class="params">
    <tr><td class="paramname">{ChromeV2}</td><td>chromeManager Instancia del administrador de Chrome. </td></tr>
    <tr><td class="paramname">{String}</td><td>url Enlace de la página a enlazar o abrir. </td></tr>
    <tr><td class="paramname">{String}</td><td>matchMode (Opcional) Tipo de búsqueda para el enlace. Puede ser: <span class="tt">exact</span>, <span class="tt">contains</span>, <span class="tt">startswith</span> o <span class="tt">regex</span>. Por defecto: <span class="tt">exact</span>. </td></tr>
    <tr><td class="paramname">{Func}</td><td>events (Opcional) Función a ejecutar cuando se reciba un mensaje de la página: <span class="tt">msg =&gt; void</span>.    <br  />
<br  />
 </td></tr>
  </table>
  </dd>
</dl>
</blockquote>
<h4 class="doxsection"><a class="anchor" id="autotoc_md7"></a>
<a class="el" href="class_j_s_wrapper.html#a8c54b3057675bc0ac4de1f56c61ab4da">Click</a></h4>
<blockquote class="doxtable">
<p>Realiza un click en el elemento seleccionado por el selector CSS proporcionado.    <br  />
<br  />
 </p>
</blockquote>
<h4 class="doxsection"><a class="anchor" id="autotoc_md8"></a>
<a class="el" href="class_j_s_wrapper.html#aea9ff0759e35eb95da38cc890892df13">EditInputBox</a></h4>
<blockquote class="doxtable">
<p>Introduce una cadena de texto en el elemento input seleccionado por el selector CSS proporcionado y dispara un evento "change" para actualizar el formulario.    <br  />
<br  />
 </p>
</blockquote>
<h4 class="doxsection"><a class="anchor" id="autotoc_md9"></a>
<a class="el" href="class_j_s_wrapper.html#a7d5fcf27e970c7e583c62611d2d714a9">SelectListBox</a></h4>
<blockquote class="doxtable">
<p>Selecciona una opción en un elemento select (lista desplegable) utilizando el índice de la opción y dispara un evento "change" para actualizar el formulario.    <br  />
<br  />
 </p>
</blockquote>
</div></div><!-- PageDoc -->
<a href="doxygen_crawl.html"></a>
</div><!-- contents -->
</div><!-- doc-content -->
</div><!-- container -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generado por <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.15.0 </li>
  </ul>
</div>
</body>
</html>
